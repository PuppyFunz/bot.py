import discord
from discord.ext import commands
import random

intents = discord.Intents.default()
intents.message_content = True  # Required for reading message content
bot = commands.Bot(command_prefix="?", intents=intents)

@bot.event
async def on_ready():
    print(f"Bot connected as {bot.user}")

@bot.command(name="send-note")
async def send_note(ctx, channel_name: str, *, message: str):
    # Find the channels
    notes_channel = discord.utils.get(ctx.guild.text_channels, name="dropped-notes")
    target_channel = discord.utils.get(ctx.guild.text_channels, name=channel_name)

    # If either doesn't exist, throw error
    if notes_channel is None:
        await ctx.send("Error: Could not find channel `notes`.")
        return
    if target_channel is None:
        await ctx.send(f"Error: Could not find channel `{channel_name}`.")
        return

    roll = random.random()
    author_name = ctx.author.display_name  # or str(ctx.author) for full tag

    if roll < 0.25:
        # 25% → send to notes
        formatted_msg = f'Note dropped from {author_name}. It reads "{message}"'
        await notes_channel.send(formatted_msg)
    else:
        # 75% → send to target channel
        formatted_msg = f'Note sent from {author_name}. It reads "{message}"'
        await target_channel.send(formatted_msg)

# Run your bot
bot.run("MTQwOTMyMzUyMDIwNjQzODU0Nw.G9SnUg.HSQ1P3KwJ9uQpq8dgCjjm5l43hO0_y8g2DYRnA")
